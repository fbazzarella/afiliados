<h1>Campanhas</h1>
<p>Aqui você pode definir o remetente, o assunto, colar o HTML da tela, selecionar a lista de destinatários e acompanhar o progresso dos envios.</p>

<div class="row">
  <%= form_for :campaign, url: campaigns_path do |f| %>
    <%#= def resource; @campaign; end; devise_error_messages! %>

    <div class="col-xs-12 col-lg-8">
      <fieldset>
        <legend>Detalhes</legend>

        <div class="row">
          <div class="col-xs-12 col-md-6">
            <div class="form-group">
              <label for="campaign_from">Remetente</label>
              <%= f.text_field :from, class: 'form-control' %>
            </div>
          </div>

          <div class="col-xs-12 col-md-6">
            <div class="form-group">
              <label for="campaign_subject">Assunto</label>
              <%= f.text_field :subject, class: 'form-control' %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-xs-12">
            <div class="form-group">
              <label for="campaign_html">HTML</label>
              <%= f.text_area :body, class: 'form-control' %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-xs-12">
            <input type="submit" class="btn btn-primary pull-right" value="Disparar Campanha!">
          </div>
        </div>
      </fieldset>
    </div>

    <div class="col-xs-12 col-lg-4">
      <fieldset class="list">
        <legend>Lista</legend>

        <p class="small">
          Emails únicos no banco de dados: <strong class="total-email-count"><%= Email.count %></strong>
        </p>

        <p class="small">
           Caso queira enviar mais uma lista, o sistema irá importá-la em segundo plano. É recomendável aguardar o fim da importação para disparar a campanha e não deixar nenhum email de fora.
        </p>

        <div class="row">
          <div class="col-xs-12">
            <div class="btn btn-sm btn-primary choose fileinput-button">
              <span>
                Selecione uma Lista...
              </span>

              <input type="file" name="list" data-url="/lists/upload" accept=".txt,.csv">
            </div>
          </div>
        </div>

        <hr />

        <h5>Envio</h5>

        <div class="row">
          <div class="col-xs-12">
            <div class="upload progress progress-striped">
              <div class="progress-bar progress-bar-primary"></div>
            </div>
          </div>
        </div>

        <h5>Importação</h5>

        <div class="row">
          <div class="col-xs-12">
            <div class="import progress progress-striped">
              <div class="progress-bar progress-bar-primary"></div>
            </div>
          </div>
        </div>
      </fieldset>
    </div>
  <% end %>
</div>
